<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Tinfinite API</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="tinfinite-api">Tinfinite API</h1>

          <h2 id="access_token">Access_token</h2>

<h3 id="get:">get:</h3>

<p><code class="prettyprint">description:获得请求的认证令牌， 以后对所有tinfinite接口的访问都需要带这个 access_token 参数</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/dr/token</code></p>

<p><code class="prettyprint">请求方式：POST</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>app_id</td>
<td>String</td>
<td>Y</td>
<td>app_id</td>
</tr>
<tr>
<td>app_user_id</td>
<td>String</td>
<td>Y</td>
<td>third_part_user_id</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>Y</td>
<td>10位linux时间戳</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>Y</td>
<td>签名（<a href="#gen_sign">见签名生成规则</a>）</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{access_token: accessToken, expire_at: expireAt}
         expire_at:token过期时间，调用token时可以根据该值判断toekn是否过期</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a></p>

          <h2 id="group">Group</h2>

<h3 id="create:">create:</h3>

<p><code class="prettyprint">description:通过第三方分组创建社区</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/community/create/third-group</code></p>

<p><code class="prettyprint">请求方式：POST</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>Y</td>
<td>10位linux时间戳</td>
</tr>
<tr>
<td>third_group_id</td>
<td>String</td>
<td>Y</td>
<td>第三方群组id</td>
</tr>
<tr>
<td>creator_id</td>
<td>String</td>
<td>N</td>
<td>创建人得tinfinite_user_id</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>N</td>
<td>群图像地址</td>
</tr>
<tr>
<td>member_count</td>
<td>String</td>
<td>N</td>
<td>人数</td>
</tr>
<tr>
<td>privilege</td>
<td>String</td>
<td>N</td>
<td>权限（0：公开，1：私有 默认1）</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Y</td>
<td>群名称</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>N</td>
<td>群简介</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>Y</td>
<td>签名（<a href="#gen_sign">见签名生成规则</a>）</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true, community_id:${community_id}}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a></p>

<h3 id="update">update</h3>

<p><code class="prettyprint">description:通过第三方分组ID更新社区</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/community/{{:third_group_id}}/update</code></p>

<p><code class="prettyprint">请求方式：POST</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>Y</td>
<td>10位linux时间戳</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>N</td>
<td>群图像地址</td>
</tr>
<tr>
<td>member_count</td>
<td>String</td>
<td>N</td>
<td>人数</td>
</tr>
<tr>
<td>privilege</td>
<td>String</td>
<td>N</td>
<td>权限（0：公开，1：私有 默认1）</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Y</td>
<td>群名称</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>N</td>
<td>群简介</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>Y</td>
<td>签名（<a href="#gen_sign">见签名生成规则</a>）</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a>  </p>

<h3 id="get_public_community">get_public_community</h3>

<p><code class="prettyprint">description:分页取得公开的社区</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/community/public/get</code></p>

<p><code class="prettyprint">请求方式：GET</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>N</td>
<td>请求时间戳，精确到秒，分页dateline</td>
</tr>
<tr>
<td>page</td>
<td>String</td>
<td>N</td>
<td>页数</td>
</tr>
<tr>
<td>limit</td>
<td>String</td>
<td>N</td>
<td>page size</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true, data : Array(results), page : page, limit : limit, timestamp : timestamp}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a> </p>

<p><code class="prettyprint">注意：请求下一页一定要带上上一页返回的timestamp， 第一页可以不传</code></p>

<h3 id="apply-telegram-group">apply telegram group</h3>

<p><code class="prettyprint">description:申请加入Telegram群组</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/telegram/group/apply/create</code></p>

<p><code class="prettyprint">请求方式：POST</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>Y</td>
<td>10位linux时间戳</td>
</tr>
<tr>
<td>telegram_group_id</td>
<td>String</td>
<td>Y</td>
<td>Telegram 分组id</td>
</tr>
<tr>
<td>telegram_username</td>
<td>String</td>
<td>N</td>
<td>Telegram 用户名</td>
</tr>
<tr>
<td>telegram_user_avatar</td>
<td>String</td>
<td>N</td>
<td>Telegram 用户头像</td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>Y</td>
<td>申请简介</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>Y</td>
<td>签名（<a href="#gen_sign">见签名生成规则</a>）</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true, id:tinfinite_id}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a> </p>

<h3 id="change-apply-status">change apply status</h3>

<p><code class="prettyprint">description:修改申请状态</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/telegram/group/apply/{{apply_id}}/update</code></p>

<p><code class="prettyprint">请求方式：POST</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>Y</td>
<td>10位linux时间戳</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>Y</td>
<td>2 通过， 3 拒绝， 0 删除</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>Y</td>
<td>签名（<a href="#gen_sign">见签名生成规则</a>）</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a> </p>

<h3 id="get_telegram_apply_list">get_telegram_apply_list</h3>

<p><code class="prettyprint">description:根据Telegram分组id分页取得申请</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/telegram/group/{{:telegram_group_id}}/apply/get</code></p>

<p><code class="prettyprint">请求方式：GET</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
<tr>
<td>timestamp</td>
<td>int</td>
<td>N</td>
<td>请求时间戳，精确到秒，分页dateline</td>
</tr>
<tr>
<td>page</td>
<td>String</td>
<td>N</td>
<td>页数</td>
</tr>
<tr>
<td>limit</td>
<td>String</td>
<td>N</td>
<td>page size</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true, data : Array(results), page : page, limit : limit, timestamp : timestamp}</p>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a> </p>

<p><code class="prettyprint">注意：请求下一页一定要带上上一页返回的timestamp， 第一页可以不传</code> </p>

<h3 id="get-user-status-in-group">get user status in group</h3>

<p><code class="prettyprint">description:取得用户在指定分组中得状态</code></p>

<p><code class="prettyprint">URL: http://api.tinfinite.com/v1.0/telegram/group/8941704/user/{{:telegram_group_id}}/status</code></p>

<p><code class="prettyprint">请求方式：GET</code></p>

<p><code class="prettyprint">参数说明：</code></p>

<table><thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>Y</td>
<td>认证令牌</td>
</tr>
</tbody></table>

<p><code class="prettyprint">返回值说明：</code></p>

<p>success:{result:true, status : status}</p>

<ul>
<li>返回结果 status： 1：申请中 2：已通过 3：被拒绝</li>
</ul>

<p>failure:{result:false, error:{message:msg, type : type, code : code}}</p>

<p><a href="#err_code">错误代码说明</a>    </p>

          <p><a name="gen_sign"></p>

<h2 id="generatesign">GenerateSign</h2>

<p></a></p>

<p><code class="prettyprint">sign 生成规则为： 按参数名称字母顺序升序排序参数列表中除sign以外的所有参数， 然后md5(key=urlencode(value.replace(&quot;&#39;()*-._!~&quot;),&#39;&#39;)……key=urlencode(value.replace(&quot;&#39;()*-._!~&quot;),&#39;&#39;)+secretkey).tolowercase</code></p>

<ol>
<li><p>先将请求参数列表按字母顺序升序排序</p></li>
<li><p>将参数值首先去掉这些特殊字符： &rsquo;()*-.<em>!~  然后进行urlencode编码，记做d</em>v</p></li>
<li><p>按排序好的参数列表顺序生成加密字符串: key1=d_v1&amp;key2=d_v2+secretkey</p></li>
<li><p>对加密串进行一次md5加密，并且将结果转换成小写</p></li>
<li><p>注意：生成sign的过程， 不要影响正常的请求参数值</p></li>
</ol>

          <p><a name="err_code"></p>

<h2 id="errorcode">ErrorCode</h2>

<p></a></p>

<table><thead>
<tr>
<th>类型</th>
<th>代码</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>100000</td>
<td>数据库不存在该数据</td>
</tr>
<tr>
<td>1</td>
<td>100001</td>
<td>数据库存储出现错误</td>
</tr>
<tr>
<td>1</td>
<td>100002</td>
<td>数据库读取出现错误</td>
</tr>
<tr>
<td>1</td>
<td>100003</td>
<td>数据库已存在该数据</td>
</tr>
<tr>
<td>1</td>
<td>100004</td>
<td>数据库操作失败</td>
</tr>
<tr>
<td>1</td>
<td>110000</td>
<td>该用户未登录,需要登录才能操作</td>
</tr>
<tr>
<td>1</td>
<td>110001</td>
<td>没有权限执行此操作</td>
</tr>
<tr>
<td>1</td>
<td>120000</td>
<td>请求缺少参数</td>
</tr>
<tr>
<td>1</td>
<td>120001</td>
<td>手机号码不合法</td>
</tr>
<tr>
<td>1</td>
<td>120002</td>
<td>存在非法参数</td>
</tr>
<tr>
<td>1</td>
<td>120003</td>
<td>数据格式不正确</td>
</tr>
<tr>
<td>1</td>
<td>120004</td>
<td>验证码不正确</td>
</tr>
<tr>
<td>1</td>
<td>120005</td>
<td>邮件发送失败</td>
</tr>
<tr>
<td>1</td>
<td>120006</td>
<td>这设备已经被初始化</td>
</tr>
<tr>
<td>1</td>
<td>130001</td>
<td>百度墨卡托坐标转换失败</td>
</tr>
<tr>
<td>1</td>
<td>140000</td>
<td>无效的token</td>
</tr>
<tr>
<td>1</td>
<td>140001</td>
<td>token已过期</td>
</tr>
<tr>
<td>1</td>
<td>140002</td>
<td>无效的请求</td>
</tr>
<tr>
<td>1</td>
<td>140003</td>
<td>无效的sign</td>
</tr>
<tr>
<td>1</td>
<td>140004</td>
<td>请求已过期</td>
</tr>
<tr>
<td>1</td>
<td>150001</td>
<td>无效的app_id</td>
</tr>
<tr>
<td>1</td>
<td>150002</td>
<td>缺少app_id</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
